#+TITLE: ENGM 401 Notes
#+AUTHOR: Arun Woosaree
#+SETUPFILE: https://fniessen.github.io/org-html-themes/org/theme-readtheorg.setup
#+LaTeX_HEADER: \usepackage{graphicx}

* Formulae
#+name: imports
#+begin_src python :tangle util.py
import numpy as np
import numpy_financial as npf
import sympy as sym
import pandas as pd
import matplotlib.pyplot as plt

# simple interest
def fv_simple(P, i, N):
    return P * (1 + i*N)

# single cash flow
# (F/P, i, N)
def FV(P, i, N):
    return P * (1 + i)**N
# single cash flow
# (P/F, i, N)
def PV(F, i, N):
    return F/(1 + i)**N
#+end_src

#+RESULTS: imports
: None

* Introduction <2021-01-11 Mon>
Chapter based study questions: use right side of brain
i.e. use common sense not exact numerical answers
answer using experience and your understanding of the concept
Some business problems have no clear answer unlike other engineering courses.
**  Chapter 1
- <<<capital expenditures>>> :: spending on behalf of the company
- selling :: know technical features and economic benefits (marketing)
- <<<operations management>>> :: know enough for day-to-day management of the business
- <<<project management>>> :: proposals and justification

*** types of businesses
- Proprietorship: a business owned by one individual (small to medium size)
- Partnership: a business with more than one owner (small to medium size)
- Corporation: a legal entity created under provincial or federal law, entity is separate from its owners and managers (medium to large size, typically large)

the engineer must estimate or forecast
1. The required investment in a project
2. The product demand
3. A selling price
4. A manufacturing cost
5. A product life

6. <<<Principle 1>>> :: A nearby penny is worth a distant dollar
   (time value of money)
7. <<<Principle 2>>> :: All that counts are the differences among alternatives
   - choices
8. <<<Principle 3>>> :: Marginal revenue must exceed marginal cost
   - \(\delta R > \delta C\)
9. <<<Principle 4>>> ::  Additional risk is not taken without the expected additional return

summary: we did the course overview
and basic principles of engineering economics

* Chapter 3 <2021-01-13 Wed>
** Story: Take a lump sum of $17 Million, or $1 Million Instalments for 25 years?

"A nearby penny is worth a distant dollar" time value of money
we need to compare the value of money received at different points in time

we use interest formulas to
*place different cash flows received at different times in the same time frame*
to compare them
** Definitions
+ Market Interest Rate ::
    the interest rate quoted by financial institutions that refers to the cost of money to borrows, or the earnings from money to lenders
+ <<<Time Value of money>>> ::
  - a dollar today is worth more than a dollar in the future because the dollar today can earn interest
  - money has both *earning power* and *purchasing power*
    + earning power :: it can earn more money over time
    + purchasing power :: loss of value because of inflation over time

    (e.g. loss of value because of inflation)
+ <<<Principal>>> ::
    the initial amount of money involving debt or investments
+ Interest rate ::
    the cost or price of the money expressed as a percentage rate per period of time
+ <<<Interest period>>> ::
    a length of time that determines how frequently interest is calculated
+ Number of interest periods ::
    specified length of time of the transaction, denoted as *N*
+ <<<Plan for receipts or Payments>>> ::
    yields a particular cash flow pattern over a specified length of time
+ <<<Future amount of money>>> ::
    how much is paid over time, principal + interest
+ A_n :: a discrete payment or receipt occurring at the end of some interest period
+ i :: interest rate per period
+ N :: number of cash flows
+ P :: Principal amount, or the
    sum of money at time=0 (present value/worth)
+ F :: Future value/future sum of money at the end of analysis
+ A :: end of period payment (uniform series) that continues for N periods.
    This is a special case where \(A_1=A_2=...=A_N\)
+ V_n :: equivalent sum of money at the end of a period n that considers the time value of money
  + \(V_0 = P\)
  + \(V_N = F\)
+ Cash flow diagram ::
  + Upward is positive cash flow
    #+begin_src sh :cache yes :exports none :results silent
    pdftoppm 'notes/lecture/markup/2021a L2 Time Value of Money SimpleCompoundInterest (with notes).pdf' converted_images/cash_flow_diagram -jpeg -f 15 -singlefile
    #+end_src


    #+attr_org: :width 256
    [[./converted_images/cash_flow_diagram.jpg]]

+ <<<End of period Convention>>> ::
    We place all cash flow transactions at the end of an interest period
+ <<<Simple Interest>>> :: charging an interest rate only on the principal
  \(F = P + I = P(1 + iN)\)
+ <<<Compound interest>>> :: charging interest on the initial sum and any previously accumulated unpaid interest
  \(F=P(1 + i)^N\)

** Economic Equivaluence
exists between individual cash flows and/or patterns of cash flows that have the *same economic effect* and could therefore
be traded for one another. Even though the amounts and timing of the cash flows might differ, the appropriaate interest rate
may make them equivalent
- One payment over time, what is the equivalent amount in the future?
- principle 1
  - equivalence calculations to compare alternatives need the same timeline
- principle 2 equivalence depends on interest rates
- principle 3 equivalence calculations may require the conversion of multiple payment cash flows to a single cash flow
- principle 4 equivalence is maintained regardless of point of view, either from the leadder or from the borrower

** Examples
*** [[pdf:./notes/lecture/markup/2021a L2 Time Value of Money SimpleCompoundInterest (with notes).pdf::13][Interest Transaction]]
- Plan 1
  + Principal: $20 000
  + Loan origination fee: $200
  + Interest rate: 9%
  + Interest period: 1 year
  + Number of interest periods: 5
  + Fee payment now plus equal annual payments
- Plan 2
  + Principal: $20 000
  + Loan origination fee: $200
  + Interest rate: 9%
  + Interest period: 1 year
  + Number of interest periods: 5
  + Fee payment now plus a single payment in year 5

| End of Year | Receipts |   Plan 1 |    Plan 2 |
|-------------+----------+----------+-----------|
|           0 |    20000 |      200 |       200 |
|           1 |          |  5141.85 |         0 |
|           2 |          |  5141.85 |         0 |
|           3 |          |  5141.85 |         0 |
|           4 |          |  5141.85 |         0 |
|           5 |          |  5141.85 | 30772.479 |
|       total |          | 25909.25 | 30972.479 |
#+TBLFM: $4=20000*1.09^5

- plan 1 is time value of money
#+begin_src python :noweb no-export :exports both
<<imports>>
return npf.pmt(0.09, 5, -20000, when='end')
#+end_src

#+RESULTS:
: 5141.849139134896

- plan 2 is compound interest

  #+begin_src python :exports both
  return 20000*1.09**5
  #+end_src

  #+RESULTS:
  : 30772.47909800001
***  [[pdf:./notes/lecture/markup/2021a L3 Economic Equivalence Single Cashflow (with notes).pdf::5][Equivalence Example 3.3]]
- 8% interest (yearly)
- what is the equivalent worth of $3000 in 5 years?
  #+begin_src python :noweb no-export :exports both
  <<imports>>
  return pv_compound(3000, 0.08, 5)
  #+end_src

  #+RESULTS:
  : 2041.7495911012588

***  [[pdf:./notes/lecture/markup/2021a L3 Economic Equivalence Single Cashflow (with notes).pdf::11][Equivalence Calculations with Multiple Payments 3.6]]
2 options to pay off a 3 year $1000 load with 10% interest:
| options                                                                        | year 1 | year 2 | year 3 |
|--------------------------------------------------------------------------------+--------+--------+--------|
| plan 1: end of year payment of interest and principal repayment at end of loan |    100 |    100 |   1100 |
| plan 2: one end of load payment of both principal and interest                 |      0 |      0 |   1131 |
|                                                                                |        |        |        |

notice how you pay $31 more by opting to pay the interest later

- option 1
  use the compound interest formula and apply it to each $100 disbursement
  #+begin_src python :noweb no-export :exports both
  <<imports>>
  return sum([FV(100, 0.1,  n) for n in range(3)])
  #+end_src

  #+RESULTS:
  : 331.0

- option 2
  a single disbursement of $331

***  [[pdf:./notes/lecture/markup/2021a L3 Economic Equivalence Single Cashflow (with notes).pdf::14][Extra Example]]
you signed a load agreement with the following terms
- borrowed amount: $2124.34
- monthly interest rate: 1%
- payment = $100 per month for 24 months
- how to interpret using equivalence?
- discounting to first payment

  \(P = \sum_{n=1}^{24} P_n\)

  \[
  P_{total} = \sum_{n=1}^{24} \frac{A_n}{(1+i)^n}
  \]

  this is a bit tedious to calculate, will introduce formulas
  
*** Interest tables
they suck
- what is the present worth of $109 472 to be received 15 periods from today at a discounting rate of 12%

  #+begin_src python :noweb no-export :exports both :results output
<<imports>>
p = PV(109472, 0.12, 15)
print("present value", p)
p = npf.pv(0.12, 15, 0, -109472)
print("present value", p)
# https://numpy.org/doc/stable/reference/generated/numpy.rate.html#numpy.rate
r = npf.rate(15, 0, -20000, 109472)
print("rate to make 20000 worth 109472", r)
n = npf.nper(0.12, 0, -20000, 109472)
print("num periods", n)
  #+end_src

  #+RESULTS:
  : present value 20000.125113114413
  : present value 20000.125113114413
  : rate to make 20000 worth 109472 0.1200004670875983
  : 15.000055199053419


*** [[pdf:./notes/lecture/markup/2021a L3 Economic Equivalence Single Cashflow (with notes).pdf::26][Example 3.11 Present Values of an Uneven Series by Decomposition into Single Payments]]
How much do you need to deposit today (P) to withdraw:
- $25 000 at n=1,
- $3000 at n=2,
- at n=4,

if your account earns 10% per period?
  #+begin_src python :noweb no-export :exports both :results value
<<imports>>
return PV(25000, 0.1, 1) + PV(3000, 0.1, 2) + PV(5000, 0.1, 4)
  #+end_src

  #+RESULTS:
  : 28621.678847073283

*** [[pdf:./notes/lecture/markup/2021a L4 Interest Formula for Conventional Series (with notes).pdf::4][Example 3.13 Present Values of an Uneven Series by Decomposition into Single Payments]]
Suppose you make an annual contribution of $3000 to your savings account at the end of each year for 10 years.
If the account earns 7% interest annually, how much can be withdrawn at the end of 10 years?
  #+begin_src python :noweb no-export :exports both :results value
<<imports>>
return npf.fv(0.07, 10, 3000, 0)
  #+end_src

  #+RESULTS:
  : -41449.34388383856

*** [[pdf:./notes/lecture/markup/2021a L4 Interest Formula for Conventional Series (with notes).pdf::7][Example 3.16 Present Values of an Uneven Series by Decomposition into Single Payments]]
A. invest $2000 per year for the first 10 years of your career 
   - at the end of 10 years, make no further investments but reinvest the amount accumulated at the end of 10 years for the next 31 years
B. do nothing for the next 10 years
   - start investing $2000 per year for the next 31 years

C. invest $2000 per year for the entire 41 years

All investments are made at the beginning of each year. The first deposit will be made at the beginning of age 25 (n=0) and you want to calculate the balance at the age of 65 (n=41)

(At time 0, work with this as a single payment)

A. TODO: this is wrong, fix it
   #+begin_src python :noweb no-export :exports both :results output
<<imports>>
a= npf.pv(0.0938, 10, 2000)
print(a)
a= npf.fv(0.0938, 31,0,  a)
print(a)
   #+end_src

   #+RESULTS:
   : -12623.389533769092
   : 203353.41688549702



** Types of cash flows
[[pdf:./notes/lecture/markup/2021a L3 Economic Equivalence Single Cashflow (with notes).pdf::20][5 Types of Cash Flows Diagrams]]
TODO: insert formula sheet
- Single cash flow :: a single present or future cash flow
  - Compound Amount Factor :: (F/A, i, N)
    \( (F/P, i, N) = (i+1)^N\)
    - computes the equivalent future value F, given a present value P
  - Present Worth Factor :: (P/A, i, N)
    \(P/F, i, N = \frac{1}{(1+i)^N}\)
    - calculates the equivalent present value P given a future falue
  - the interest rate \(i\) and the \(P/F\) factor are also referred to as the <<<discount rate>>> and <<<discounting factor>>>
- Equal (uniform) series :: (uniform) a series of cash flows of equal amounts at regular intervals
- Linear Gradient Series :: a series of cash flows increasing or decreasing by a fixed amount at regular intervals
- Geometric Gradient Series :: a series of cash flows increasing or decreasing by a fixed percentage at regular intervals
  - aka compounding series
- Irregular (Mixed) Series :: a series of cash flows exhibiting no overall pattern
  + there still might be patterns for portions of the series, but overall there is no pattern
- Sinking Fund Factor :: (A/F, i, N)
  - a sinking fund is an interest bearing account into which a fixed sum is deposited each interest period
  - it is commonly established for the purpose of replacing fixed assets or retiring corporate bonds
